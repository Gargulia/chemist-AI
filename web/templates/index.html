<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Монастырёв</title>
		<link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
		<link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet">
		<link rel="stylesheet" href="static/style/style.css">
		<!-- <script src="https://ajax.googleapis.com/ajax/libs/d3js/5.7.0/d3.min.js"></script> -->
		<script src="static/scripts/jquery-3.3.1.min.js"></script>
		<script src="static/scripts/jquery.cookie.js"></script>
	</head>
	<body>
		<div class="top_info">
			<div class="logo"></div>
			<div class="geo" style="padding: 0 40px;">
				<div class="icon icon--geo"><p>Владивосток</p></div>
				<h4>24 аптеки</h4>
			</div>
			<div class="phone">
				<div class="icon icon--phone"><p>8 800 707 77 33</p></div>
				<h4>с 7:00 до 23:00</h4>
			</div>
		</div>
		<div class="menu" style="top: 75px">
			<a class="menu__item jsFromLeft" href="/">Главная</a>
			<a class="menu__item" href="#">О нас</a>
			<a class="menu__item" href="#">Наши аптеки</a>
			<a class="menu__item" href="#">Скидки</a>
			<a class="menu__item menu__item--cart jsFromRight" href="cart"><div class="cart_button"><div class="icon icon--cart"></div><p class="cart_button__text">Корзина пуста</p></div></a>
		</div>
		<h1 class="jsFromLeft">Каталог</h1>
		<div class="content">
			{% for name, price, category, id in info %}
			<div class="card">
				<div class="product_image" style="background-image: url('static/images/products/{{ id }}.JPG');"></div>
				<div class="product_name">{{ name }}</div>
				<div class="product_price">{{ price }}</div>
				<div class="add_to_cart" itemID="{{ id }}"></div>
			</div>
			{% endfor %}
		</div>
		<script src="static/scripts/script.js"></script>
		<script>
		let page = 1;
		$(window).on("scroll", function() {
			if(($(document).outerHeight() - ($(window).height() + $(window).scrollTop())) < 350){
				page++;
				$.ajax({
					url: '/get_goods/' + page,
					success: function(data){
					console.log(data);
						for(let i = 0; i < data.length; i++){
							$(".content").html($(".content").html() + `
							<div class="card">
								<div class="product_image" style="background-image: url('static/images/products/` + data[i][3] + `.JPG');"></div>
								<div class="product_name">` + data[i][0] + `</div>
								<div class="product_price">` + data[i][1] + `</div>
								<div class="add_to_cart" itemID="` + data[i][3] + `"></div>
							</div>
							`);
						}
					}
				});
			}
			//console.log(($(document).outerHeight() - ($(window).height() + $(window).scrollTop())));
		});
		</script>
	</body>
</html>